# Домашнее задание к занятию "11.02 Микросервисы: принципы"

## Задача 1: API Gateway

### Вопрос
Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:

Маршрутизация запросов к нужному сервису на основе конфигурации
Возможность проверки аутентификационной информации в запросах
Обеспечение терминации HTTPS
Обоснуйте свой выбор.

### Ответ
| Сервис | Маршрутизация | аутентификация | терминация HTTPS | внешняя СУБД | мониторинг | протоколы |
|--------|---------------|----------------|------------------|--------------|------------|-----------|
| [Nginx](http://nginx.org/) | Load balancer, Reverse proxy, Rate limiting | HTTP Basic Authentication  | TLS offload |  не требуется | external monitoring tools | HTTP/2 server push gRPC proxy |
| [HAProxy](http://www.haproxy.org/) | Load Balancing, Rate Limiting| да | HTTPS Termination |  не требуется | syslog | REST |
| [Kong](https://konghq.com/products/api-gateway-platform) | Rate Limiting, Load Balancing | Auth, HMAC, JWT Key Auth, limited OAuth 2.0, limited LDAP | да | не требуется(PostgreSQL) | File logging, HTTP logging, basic StatsD, TCP/UDP logging | REST, gRPC |
| [Tyk](https://tyk.io/) | Rate Limiting | OIDC, JWT, bearer Tokens, Basic Auth, Client Certificates | да |  Redis | да | REST, SOAP, GraphQL, gRPC|
| [KrakenD](https://www.krakend.io/) | Load Balancing, Rate limit, Sequential proxy | JWT, OAuth2 | TLS | не требуется | Metrics, Tracing, Alerting |  REST, GraphQL  |

Для перечисленных требований в качестве решения можно использовать любой продукт из таблицы. Nginx, HAProxy являются стабильными, надежными решениями, их функционала будет достаточно для обеспечения балансировки, проксирования соединений, установки как внешних так и внутренних лимитов сторости/времени подключения. Так же оба продукта могут обеспечить терминацию https трафика пользователей.  
Tyk и Kong, KrakenD являются полноценнми программынми API шлюзами, они способны предложить владельцу расширенный функционал авторизации, единый протокол API для всех клиентов, продвинутые функции администрирования и мониторинга состояния. Множество интересных функций к сожалению доступны только в Enterprise версии. 

Для обеспечения реализации API Gateway, при условии наличия бюджета, я предложил бы использовать Kong, т.к. он базируется на Nginx, что обеспечивет надежность и скорость работы базовых функций управления трафиком. Использование Lua позволяет реализовать сложную логику работы с пользователями/сервисами. 

<details>
## Задача 2: Брокер сообщений


### Вопрос
Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:

* Поддержка кластеризации для обеспечения надежности
* Хранение сообщений на диске в процессе доставки
* Высокая скорость работы
* Поддержка различных форматов сообщений
* Разделение прав доступа к различным потокам сообщений
* Проcтота эксплуатации
Обоснуйте свой выбор.

### Ответ

| Сервис | Кластеризация | Хранение данных | форматы сообщений | права доступа | Скорость работы | Простота эксплуатации |
|--------|---------------|-----------------|-------------------|---------------|-----------------|-----------------------|
| Kafka  |---------------|-----------------|-------------------|---------------|-----------------|-----------------------|
|RabbitMQ|---------------|-----------------|-------------------|---------------|-----------------|-----------------------|
| ZeroMQ |---------------|-----------------|-------------------|---------------|-----------------|-----------------------|
|Message Bus|------------|-----------------|-------------------|---------------|-----------------|-----------------------|
| RestMQ |---------------|-----------------|-------------------|---------------|-----------------|-----------------------|

</details>