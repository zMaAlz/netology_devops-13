# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"

## Задание 1: Описать требования к кластеру

<details>

------

Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
* Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
* Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.
------
</details>


Варианты развертывания:
1. Собственные мощности. Гиперконвергентный кластер из 3 серверов виртуализации KVM + QEMU + vibvirt с файловой системой Ceph. 

Для СУБД используем выделенные виртуальные машины, для обеспечения ресурсами потребности ОС и СУБД минимальные характеристики ВМ будут следующими: 6Гб ОЗУ, 2 CPU, 250ГБ Диск. Kubernetes Control Plane - 3 ноды (2 CPU, 2Гб ОЗУ, 70Гб Диск на каждую ВМ). Kubernetes node - 3 ноды, с учетом размещения КЭШа, фронтенд и Бекенд характеристики каждой ВМ Kube-node следующие - 6 CPU, 8Гб ОЗУ, Диск 100Гб. Для обеспечения бесперебойной работы при выходе 1 ноды из строя увеличим все параметры в 1.5 раза. 9 CPU, 12Гб ОЗУ, Диск 150Гб. 

На каждом сервере будут размещаться:

* ВМ для СУБД - 6Гб ОЗУ, 2 CPU, 250ГБ Диск
* ВМ для Kube-Control-Plane - 2 CPU, 2Гб ОЗУ, 70Гб Диск
* ВМ для Kube-node - 9 CPU, 12Гб ОЗУ, Диск 150Гб
    - Kube-node - 1Гб ОЗУ, 1 CPU
    - КЭШ 1 копии - 4Гб ОЗУ, 1 CPU
    - Фронтенд 2 копий - 100Мб ОЗУ, 0,4 CPU
    - Бекенд 3 копий - 1,8Гб ОЗУ, 3 CPU

2. Облакчная инфраструктура (IaaS). 


Использование облачной инфраструктуры для развертывания сохраняет гибкость и вариативность настройки, но облегчает последующее масштабирование сервиса. Поскольку за доступность нод отвечает облачный провайдер, закладывать дополнительные мощности для резервирования нет необходимости.  

* ВМ для СУБД (3 шт.) - 6Гб ОЗУ, 2 CPU, 250ГБ Диск
* ВМ для Kube-Control-Plane (3 шт.)  - 2 CPU, 2Гб ОЗУ, 70Гб Диск
* ВМ для Kube-node (3 шт.) - 6 CPU, 8Гб ОЗУ, Диск 100Гб
    - Kube-node - 1Гб ОЗУ, 1 CPU
    - КЭШ 1 копии - 4Гб ОЗУ, 1 CPU
    - Фронтенд 2 копий - 100Мб ОЗУ, 0,4 CPU
    - Бекенд 3 копий - 1,8Гб ОЗУ, 3 CPU


3. Kubernetes как сервис (PaaS)

Так же как и при использовании собственных мощностей мы будем создавать ВМ для СУБД, но кластер Kubernetes можно преобрести как сервис, что уменьшит затраты на администрирование. 

* ВМ для СУБД (3 шт.)  - 6Гб ОЗУ, 2 CPU, 250ГБ Диск
* ВМ для Kube-node (3 шт.) - 6 CPU, 8Гб ОЗУ, Диск 100Гб
    - Kube-node - 1Гб ОЗУ, 1 CPU
    - КЭШ 1 копии - 4Гб ОЗУ, 1 CPU
    - Фронтенд 2 копий - 100Мб ОЗУ, 0,4 CPU
    - Бекенд 3 копий - 1,8Гб ОЗУ, 3 CPU
